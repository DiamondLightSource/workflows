services:
  sessionspaces:
    build:
      context: .
      dockerfile: Dockerfile
    network_mode: "host"
    volumes:
      - ../../..:/workspace:cached,z
      - "~/.kube:/root/.kube"
    command: sleep infinity
    environment:
      DATABASE_URL: mysql://root:rootpassword@localhost/ispyb_build

  ispyb:
    image: ghcr.io/diamondlightsource/ispyb-database:v3.0.0
    restart: unless-stopped
    network_mode: "host"
    ports:
      - 3306:3306
    environment:
      MARIADB_ROOT_PASSWORD: rootpassword
